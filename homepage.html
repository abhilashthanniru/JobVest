<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JobVest</title>
    <link rel="stylesheet" href="./style.css">
</head>
<body>
   <nav class="navbar">
    <div class="nav">
      <img src="./images/logo1.png" alt="Logo" style="width: 40px;">
      <div class="search-container">
          <input type="text" id="searchInput" class="search-input" placeholder="Search for jobs or people">
          <select id="filterCategory" class="filter-select">
              <option value="all">All</option>
              <option value="users">Users</option>
              <option value="jobs">Jobs</option>
          </select>
      </div>
    </div>
    <div class="results-container" id="searchResults"></div>
    <div class="nav-mid">
        <ul>
            <li><a href="./homepage.html" class="activelink"><img src="./images/home.png" alt=""><span>Home</span></a></li>
            <li><a href="./network.html"><img src="./images/network.png" alt=""><span>My Network</span></a></li>
            <li><a href="./jobs.html"><img src="./images/jobs.png" alt=""><span>Jobs</span></a></li>
            <li><a href="./messaging.html"><img src="./images/message.png" alt=""><span>Messaging</span></a></li>
            <li><a href="./funding.html"><img src="./images/notification.png" alt=""><span>Funding</span></a></li>
        </ul>
    </div>
    <img src="./images/moon.png" id="icon">
    <div class="nav-right">
        <div class="online">
            <img src="./images/user-1.png" class="nav-profile-img" onclick="toggleMenu()" >
        </div>
    </div>
    <div class="profile" id="profileMenu">
      <div class="profile_menu">
        <div class="user-info">
          <img src="./images/user-1.png" alt="">
          <div>
            <h3>Rayan Walton</h3>
            <a href="profile.html">See your profile</a>
          </div>
        </div>
        <hr>
        <a href="" class="profilemenu_link">
        <img src="./images/feedback.png" alt="">
        <p>Give feedback</p>
        <span>></span></a>
        <a href="" class="profilemenu_link">
            <img src="./images/setting.png" alt="">
            <p>Settings & Privacy</p>
            <span>></span></a>
            <a href="" class="profilemenu_link">
              <img src="./images/help.png" alt="">
              <p>Help & Support</p>
              <span>></span></a>
              <a href="./index.html" class="profilemenu_link">
                <img src="./images/logout.png" alt="">
                <p>Logout</p>
                <span>></span></a>
      </div>
    </div>
   </nav>
   <div class="container">
    <div class="left-side"> 
      <div class="sidebar-profile-box">
        <img src="./images/cover-pic.png" width="100%">
        <div class="sidebar-profile-info">
          <img src="./images/user-1.png" alt="">
          <h1>Rayan</h1>
          <h3>Web Developer at Microsoft</h3>
          <ul>
            <li>your profile views <span>52</span></li>
            <li>your post views <span>810</span></li>
            <li>your connections <span>405</span></li>
          </ul>
        </div>
        <div class="sidebar-profile-link">
          <a href=""><img src="./images/items.png" alt="">My items</a>
          <a href="./trypremium.html"><img src="./images/premium.png" alt="">Try premium</a>
        </div>
      </div>
      <div class="sidebar-activity">
        <h3>RECENT</h3>
        <a href=""><img src="./images/recent.png" alt="">Web Development</a>
        <a href=""><img src="./images/recent.png" alt="">User Interface</a>
        <a href=""><img src="./images/recent.png" alt="">Online Learning</a>
        <a href=""><img src="./images/recent.png" alt="">Learn Online</a>
        <a href=""><img src="./images/recent.png" alt="">Code Better</a>
        <a href=""><img src="./images/recent.png" alt="">Group Learning</a>
        <h3>GROUPS</h3>
        <a href=""><img src="./images/group.png" alt="">Web Design Group</a>
        <a href=""><img src="./images/group.png" alt="">HTML & CSS Learners</a>
        <a href=""><img src="./images/group.png" alt="">Python & JavaScript Group</a>
        <a href=""><img src="./images/group.png" alt="">Learn Coding Online</a>
        <h3>HASTAG</h3>
        <a href=""><img src="./images/hashtag.png" alt="">Webdevelopment</a>
        <a href=""><img src="./images/hashtag.png" alt="">userinterface</a>
        <a href=""><img src="./images/hashtag.png" alt="">Onlinelearning</a>
        <div class="discover-more-link">
          <a href="">Discover more</a>
        </div>
      </div>
    </div>
    <div class="middle">
      <div class="create-post">
          <div class="create-post-input">
              <img id="current-user-pic" src="./images/user-1.png" alt="User Profile">
              <textarea id="post-text" rows="2" placeholder="Write a post"></textarea>
          </div>
          <div class="post-options">
              <label for="photo-upload" class="btn">
                  üì∑ Photo
                  <input type="file" id="photo-upload" accept="image/*" class="hidden-input">
              </label>
  
              <label for="video-upload" class="btn">
                  üé• Video
                  <input type="file" id="video-upload" accept="video/*" class="hidden-input">
              </label>
  
              <button class="btn">üìÑ Event</button>
              <button id="post-btn" class="btn active">üìù Post</button> <!-- POST BUTTON -->
          </div>
      </div>
  
      <div class="feed-container">
          <div id="feed"></div> <!-- Posts will be added here dynamically -->
      </div>
  </div>
  
    <div class="right-side">
      <div class="sidebar-news">
        <img src="./images/more.png" class="info-icon">
        <h3>Trending News</h3>
        <a href="">High demand for skilled manpower</a>
        <span>1d ago &middot; 10,934 readers</span>
        <a href="">Careers growing horizontally too</a>
        <span>7h ago &middot; 9, 434 readers</span>
        <a href="">Less work via for US,more of uk</a>
        <span>2d ago &middot; 2,834 readers</span>
        <a href="">Fastest-growing jobs in Indian cities</a>
        <span>19h ago &middot; 15,634 readers</span>
        <a href="">India is shining bright in R&D </a>
        <span>6h ago &middot; 5,732 readers</span>
        <a href="" class="readmore">Read More</a>
      </div>
      <div class="sidebar-ad">
        <small>Ad &middot; &middot; &middot;</small>
        <p>Master the 5 principles of web designing</p>
        <div>
          <img src="./images/user-1.png" alt="">
          <img src="./images/mi-logo.png" alt="">
        </div>
        <b>Brand and Demand in Xiaomi</b>
        <a href="" class="ad-link">Learn More</a>
      </div>
      <div class="sidebar-useful">
        <a href="">About</a>
        <a href="">Accessibility</a>
        <a href="">Help Center</a>
        <a href="">Privacy Policy</a>
        <a href="">Advertising</a>
        <a href="">Get the app</a>
        <a href="">More</a>
      </div>
      <div class="copyright">
        <img src="./images/logo1.png" alt="">
        <p>FundHire &#169; 2025. All rights reserved</p>
      </div>
    </div>
   </div>
   <script>
    let darkbtn = document.getElementById("icon");
const body = document.body;

// Enable Dark Mode
function enableDarkMode() {
    body.classList.add("dark-mode");
    localStorage.setItem("dark-mode", "enabled");
    darkbtn.src = "./images/sun.png"; 
}

// Disable Dark Mode
function disableDarkMode() {
    body.classList.remove("dark-mode");
    localStorage.setItem("dark-mode", "disabled");
    darkbtn.src = "./images/moon.png"; 
}

// Check local storage for dark mode setting
if (localStorage.getItem("dark-mode") === "enabled") {
    enableDarkMode();
}

// Toggle Dark Mode on button click
darkbtn.addEventListener("click", () => {
    if (body.classList.contains("dark-mode")) {
        disableDarkMode();
    } else {
        enableDarkMode();
    }
});


  //-------feed----
  document.addEventListener("DOMContentLoaded", () => {
    const feedContainer = document.getElementById("feed");
    
    fetch("https://679cae8087618946e65305b2.mockapi.io/feed")
      .then((response) => response.json())
      .then((data) => {
        data.forEach((post) => {
          const postCard = document.createElement("div");
          postCard.classList.add("post-card");

          // Post media (image or video)
          let mediaContent = "";
          if (post.image) {
            mediaContent = `<img src="${post.image}" class="post-media">`;
          } else if (post.video) {
            mediaContent = `<video controls class="post-media"><source src="${post.video}" type="video/mp4"></video>`;
          }

          postCard.innerHTML = `
                        <div class="post-header">
                            <img src="${post.user?.profileImage}" alt="Profile" class="profile-img">
                            <div>
                                <h4>${post.user?.name || "Unknown User"}</h4>
                                <p>${post.user?.designation || "No Designation"}</p>
                            </div>
                        </div>
                        <p class="post-content">${post.content}</p>
                        ${mediaContent}
                        <div class="post-footer">
                            <button class="like-btn" data-post-id="${post.id}">
                                üëç <span class="like-count">${post.likes}</span> Likes
                            </button>
                            <span>üí¨ ${post.comments} Comments</span>
                        </div>
                    `;
          
          feedContainer.appendChild(postCard);

          // Like button functionality
          const likeButton = postCard.querySelector(".like-btn");
          const likeCount = likeButton.querySelector(".like-count");
          let hasLiked = false;

          likeButton.addEventListener("click", () => {
            if (!hasLiked) {
              hasLiked = true;
              likeCount.textContent = parseInt(likeCount.textContent) + 1;
              likeButton.disabled = true;
            }
          });
        });
      })
      .catch((error) => console.error("Error fetching feed:", error));
});



  document.addEventListener("DOMContentLoaded", function () {
    const postButton = document.querySelector(".post-options .active");
    const textArea = document.querySelector(".create-post-input textarea");
    const photoUpload = document.getElementById("photo-upload");
    const videoUpload = document.getElementById("video-upload");
    const feed = document.getElementById("feed");

    postButton.addEventListener("click", function () {
        const postText = textArea.value.trim();
        const photoFile = photoUpload.files[0];
        const videoFile = videoUpload.files[0];

        if (postText === "" && !photoFile && !videoFile) {
            alert("Post cannot be empty!");
            return;
        }

        // Create post container
        const postDiv = document.createElement("div");
        postDiv.classList.add("post");

        // Profile Picture (Fixed Smaller Size)
        let postContent = `
            <div class="post-header">
                <img src="./images/user-1.png" alt="User" class="profile-pic">
                <div class="user-info">
                    <strong>John Doe</strong>
                    <p>Software Engineer at Google</p>
                </div>
            </div>
            <p class="post-content">${postText}</p>
        `;

        // Handle Image Upload
        if (photoFile) {
            const photoURL = URL.createObjectURL(photoFile);
            postContent += `<img src="${photoURL}" alt="Post Image" class="post-media">`;
        }

        // Handle Video Upload
        if (videoFile) {
            const videoURL = URL.createObjectURL(videoFile);
            postContent += `
                <video controls class="post-media">
                    <source src="${videoURL}" type="${videoFile.type}">
                    Your browser does not support the video tag.
                </video>
            `;
        }

        // Add Like & Comment Section
        postContent += `
            <div class="post-actions">
                <button class="like-btn">üëç Like <span class="like-count">0</span></button>
                <button class="comment-btn">üí¨ Comment</button>
            </div>
            <div class="comment-section">
                <input type="text" class="comment-input" placeholder="Write a comment...">
                <button class="add-comment">Post</button>
                <div class="comments-list"></div>
            </div>
        `;

        postDiv.innerHTML = postContent;
        feed.prepend(postDiv);

        // Clear Inputs
        textArea.value = "";
        photoUpload.value = "";
        videoUpload.value = "";

        // Like Button Fix (Allow Only One Like)
        const likeButton = postDiv.querySelector(".like-btn");
        const likeCount = postDiv.querySelector(".like-count");
        let liked = false;

        likeButton.addEventListener("click", function () {
            if (!liked) {
                likeCount.textContent = parseInt(likeCount.textContent) + 1;
                likeButton.style.color = "blue";
                liked = true;
            }
        });

        // Comment Functionality
        const commentInput = postDiv.querySelector(".comment-input");
        const addCommentButton = postDiv.querySelector(".add-comment");
        const commentsList = postDiv.querySelector(".comments-list");

        addCommentButton.addEventListener("click", function () {
            const commentText = commentInput.value.trim();
            if (commentText !== "") {
                const comment = document.createElement("p");
                comment.classList.add("comment");
                comment.textContent = commentText;
                commentsList.appendChild(comment);
                commentInput.value = "";
            }
        });
    });
});

//------------------------------search--------------//
const searchInput = document.getElementById('searchInput');
        const filterCategory = document.getElementById('filterCategory');
        const searchResults = document.getElementById('searchResults');
        let debounceTimer;

        searchInput.addEventListener('input', () => {
            clearTimeout(debounceTimer);
            debounceTimer = setTimeout(fetchResults, 500);
        });

        filterCategory.addEventListener('change', fetchResults);

        async function fetchResults() {
            const query = searchInput.value.trim().toLowerCase();
            const category = filterCategory.value;
            searchResults.innerHTML = '';

            if (query.length < 2) {
                searchResults.style.display = 'none';
                return;
            }
            searchResults.style.display = 'block';

            try {
                const [users, jobs] = await Promise.all([
                    fetch('https://67ae21869e85da2f020c863f.mockapi.io/network').then(res => res.json()),
                    fetch('https://679cae8087618946e65305b2.mockapi.io/jobapplications').then(res => res.json())
                ]);

                let resultsHTML = '';

                if (category === 'all' || category === 'users') {
                    users.forEach(user => {
                        if (user.name?.toLowerCase().includes(query)) {
                            resultsHTML += `<div class="result-item" onclick="goToProfile('${user.id}')">
                                <img src="${user.profilePicture || 'https://via.placeholder.com/40'}" alt="Profile Pic"> 
                                <div>
                                    <strong>${user.name}</strong><br>
                                    <small>${user.jobTitle || 'No Title'}</small>
                                </div>
                            </div>`;
                        }
                    });
                }

                if (category === 'all' || category === 'jobs') {
                    jobs.forEach(job => {
                        if (job.jobTitle?.toLowerCase().includes(query)) {
                            resultsHTML += `<div class="result-item" onclick="viewJob('${job.id}')">
                                üè¢ <strong>${job.jobTitle}</strong> at ${job.company || 'Unknown Company'}
                            </div>`;
                        }
                    });
                }

                searchResults.innerHTML = resultsHTML || '<div class="result-item">No results found</div>';
            } catch (error) {
                console.error("Error fetching data:", error);
                searchResults.innerHTML = '<div class="result-item">Error loading data</div>';
            }
        }

        function goToProfile(userId) {
            window.location.href = `network.html?id=${userId}`;
        }

        function viewJob(jobId) {
            window.location.href = `jobs.html?id=${jobId}`;
        }

        document.addEventListener('click', (e) => {
            if (!document.querySelector('.search-container').contains(e.target)) {
                searchResults.style.display = 'none';
            }
        });
  </script>
</body>
</html>